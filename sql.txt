Question- [1]
WITH EMPCOUNT AS(SELECT PROJECT_ID,
COUNT(EMP_ID) AS NUM_EMP
FROM allocation
GROUP BY PROJECT_ID)
SELECT projectid FROM PROJ_EMP_COUNT
WHERE NUMEMP=( 
SELECT MAX(NUM_EMP) 
FROM EMPCOUNT );

Question-[2] 
SELECT employee.EMP_ID, EMP_NAME FROM employee
WHERE employee.EMP_ID NOT IN(
SELECT allocation.EMP_ID from allocation GROUP BY EMP_ID
);

Question-[3] 
WITH ROLL_TABLE AS(
SELECT ROLE_ID, COUNT(ROLE_ID) AS ROLE_COUNT
FROM allocation
WHERE EMP_ID='E003'
GROUP BY ROLE_ID);
SELECT ROLE_TITLE FROM role
WHERE ROLE_ID=(
SELECT ROLE_ID FROM ROLE_TABLE
WHERE ROLE_COUNT=(SELECT MAX(ROLE_COUNT) FROM ROLL_TABLE );

Question – [4] 
WITH PROJ_COST AS(
SELECT PROJECT_ID,
SUM(AMOUNT_PER_DAY * (TO_DATE – FROM_DATE)) AS COST_PER_DAY
FROM allocation GROUP BY PROJECT_ID)
SELECT PROJECT_ID FROM PROJ_COST
WHERE COST_PER_DAY=(SELECT MAX(COST_PER_DAY) FROM PROJ_COST);

Question – [5] 
WITH PROJ_COST AS(
SELECT PROJECT_ID,
SUM(AMOUNT_PER_DAY * (TO_DATE – FROM_DATE)) AS COST_PER_DAY,
COUNT(EMP_ID) AS NUM_EMP
FROM allocation GROUP BY PROJECT_ID)
SELECT NUM_EMP FROM PROJ_COST
WHERE COST_PER_DAY=(SELECT MAX(COST_PER_DAY) FROM PROJ_COST);

Question – [6] 
WITH PROJ_COST AS(
SELECT PROJECT_ID,
SUM(AMOUNT_PER_DAY * (TO_DATE – FROM_DATE)) AS COST_PER_DAY,
COUNT(EMP_ID) AS NUM_EMP
FROM allocation GROUP BY PROJECT_ID)
SELECT PROJECT_ID FROM PROJ_COST
WHERE COST_PER_DAY=(SELECT MIN(COST_PER_DAY) FROM PROJ_COST);

Question – [7] 
SELECT COUNT(PROJECT_ID) FROM allocation
WHERE EMP_ID=(
SELECT EMP_ID FROM employee
WHERE HIRE_DATE=(SELECT MIN(HIRE_DATE) FROM employee) );
--no projects are handled by the senior most employee

Question - [10] 
date in Allocation table)?
SELECT PROJECT_ID 
FROM allocation
WHERE to_date <= '2022-03-10' GROUP BY PROJECT_ID